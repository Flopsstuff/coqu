## Why

Проекты в coqu содержат клонированные кодовые базы, но пока нет способа взаимодействовать с кодом программно — задавать вопросы, анализировать, получать ответы. Нужна инфраструктура AI-агентов, которые работают внутри контейнера в директории проекта. Начинаем с Claude Code (через `@anthropic-ai/claude-code`), с возможностью расширения на другие типы агентов.

## What Changes

- Новая модель `Agent` в БД — самостоятельная сущность, не привязанная к проекту (тип, статус установки, набор env-переменных). В перспективе каждый агент сможет взаимодействовать с любым проектом
- Новые API-эндпоинты для CRUD агентов (`/api/agents`)
- Установка/удаление агентского SDK внутри контейнера управляется бэкендом (npm install/uninstall через child process в рантайме, без изменений Dockerfile)
- Новая страница "Agents" на фронтенде — список агентов, форма добавления, настройки
- Новые shared-типы для агентов
- Env-переменные агентов хранятся в файлах на volume (`$HOME`), не в БД. Поддержка разных провайдеров инференса (Anthropic direct, Amazon Bedrock, Google Vertex)
- Новая страница редактирования env-файла агента на фронтенде — текстовый редактор для `.env` файла с сохранением через API

## Capabilities

### New Capabilities
- `agent-management`: CRUD операции для агентов — модель данных, API-эндпоинты, установка SDK в рантайме, фронтенд-страница настроек. Агенты — независимые сущности, не привязанные к проектам

### Modified Capabilities
_(нет изменений в существующих спеках)_

## Impact

- **Database**: Новая таблица `Agent` (без FK на Project), миграция Prisma
- **API** (`packages/api`): Новые роуты `/api/agents`, сервис установки SDK через `child_process` (npm install внутри контейнера), эндпоинты чтения/записи env-файла агента
- **Shared** (`packages/shared`): Новые типы `Agent`, `AgentType`, `AgentStatus`, `CreateAgentRequest`, `UpdateAgentRequest`
- **Web** (`packages/web`): Новая страница/компоненты для управления агентами
- **Dependencies**: `@anthropic-ai/claude-code` устанавливается глобально бэкендом в рантайме (`npm install -g`). При старте API — health check: сверка фактически установленных агентов с системой, автоматическая переустановка отсутствующих
- **Docker**: Новый named volume `home_data`, монтируется в `$HOME` API-контейнера. Персистит данные агентов (`~/.claude/` и т.п.) между рестартами. Бинарники не персистятся — переустанавливаются автоматически
- **Security**: Env-переменные хранятся в файлах на volume (не зашифрованы). Доступ контролируется правами файловой системы контейнера
